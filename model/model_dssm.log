(184680, 118)
(10135, 118)
(184680, 118) (10135, 118)
2018-07-06 11:22:26.521801: I tensorflow/core/platform/cpu_feature_guard.cc:140] Your CPU supports instructions that this TensorFlow binary was not compiled to use: AVX2 FMA
2018-07-06 11:22:27.234768: I tensorflow/stream_executor/cuda/cuda_gpu_executor.cc:898] successful NUMA node read from SysFS had negative value (-1), but there must be at least one NUMA node, so returning NUMA node zero
2018-07-06 11:22:27.235129: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1212] Found device 0 with properties: 
name: GeForce GTX 1070 Ti major: 6 minor: 1 memoryClockRate(GHz): 1.683
pciBusID: 0000:0c:00.0
totalMemory: 7.92GiB freeMemory: 7.81GiB
2018-07-06 11:22:27.235146: I tensorflow/core/common_runtime/gpu/gpu_device.cc:1312] Adding visible gpu devices: 0
2018-07-06 11:22:27.413975: I tensorflow/core/common_runtime/gpu/gpu_device.cc:993] Creating TensorFlow device (/job:localhost/replica:0/task:0/device:GPU:0 with 7542 MB memory) -> physical GPU (device: 0, name: GeForce GTX 1070 Ti, pci bus id: 0000:0c:00.0, compute capability: 6.1)

 dssm_fold0.h5 curr_fold: 0
Train on 161595 samples, validate on 23085 samples
Epoch 1/200
 - 38s - loss: 0.4768 - acc: 0.8004 - val_loss: 0.4352 - val_acc: 0.8244
Epoch 2/200
 - 37s - loss: 0.4231 - acc: 0.8240 - val_loss: 0.4158 - val_acc: 0.8281
Epoch 3/200
 - 36s - loss: 0.4044 - acc: 0.8291 - val_loss: 0.4076 - val_acc: 0.8306
Epoch 4/200
 - 36s - loss: 0.3894 - acc: 0.8343 - val_loss: 0.3979 - val_acc: 0.8304
Epoch 5/200
 - 36s - loss: 0.3770 - acc: 0.8385 - val_loss: 0.3954 - val_acc: 0.8298
Epoch 6/200
 - 36s - loss: 0.3630 - acc: 0.8440 - val_loss: 0.3895 - val_acc: 0.8356
Epoch 7/200
 - 36s - loss: 0.3497 - acc: 0.8491 - val_loss: 0.3889 - val_acc: 0.8358
Epoch 8/200
 - 36s - loss: 0.3361 - acc: 0.8556 - val_loss: 0.3957 - val_acc: 0.8368
Epoch 9/200
 - 36s - loss: 0.3203 - acc: 0.8632 - val_loss: 0.4020 - val_acc: 0.8362
Epoch 10/200
 - 36s - loss: 0.3038 - acc: 0.8703 - val_loss: 0.4334 - val_acc: 0.8344
Epoch 11/200
 - 36s - loss: 0.2877 - acc: 0.8770 - val_loss: 0.4303 - val_acc: 0.8337
Epoch 12/200
 - 36s - loss: 0.2706 - acc: 0.8851 - val_loss: 0.4306 - val_acc: 0.8298
Dev eval precision 0.4772908366514849
Dev eval recall 0.6399572649538464
Dev eval accuracy 0.8040453872710369
Dev eval F1-score 0.5467822862947318

 dssm_fold1.h5 curr_fold: 1
Train on 161595 samples, validate on 23085 samples
Epoch 1/200
 - 38s - loss: 0.4798 - acc: 0.7994 - val_loss: 0.4294 - val_acc: 0.8234
Epoch 2/200
 - 36s - loss: 0.4274 - acc: 0.8235 - val_loss: 0.4103 - val_acc: 0.8259
Epoch 3/200
 - 36s - loss: 0.4050 - acc: 0.8291 - val_loss: 0.3965 - val_acc: 0.8314
Epoch 4/200
 - 36s - loss: 0.3878 - acc: 0.8344 - val_loss: 0.3885 - val_acc: 0.8354
Epoch 5/200
 - 36s - loss: 0.3723 - acc: 0.8402 - val_loss: 0.3901 - val_acc: 0.8353
Epoch 6/200
 - 36s - loss: 0.3566 - acc: 0.8470 - val_loss: 0.3862 - val_acc: 0.8374
Epoch 7/200
 - 36s - loss: 0.3390 - acc: 0.8539 - val_loss: 0.3865 - val_acc: 0.8355
Epoch 8/200
 - 36s - loss: 0.3205 - acc: 0.8626 - val_loss: 0.3954 - val_acc: 0.8367
Epoch 9/200
 - 36s - loss: 0.3010 - acc: 0.8718 - val_loss: 0.3997 - val_acc: 0.8352
Epoch 10/200
 - 36s - loss: 0.2799 - acc: 0.8803 - val_loss: 0.4261 - val_acc: 0.8360
Epoch 11/200
 - 36s - loss: 0.2619 - acc: 0.8885 - val_loss: 0.4181 - val_acc: 0.8340
Dev eval precision 0.4845402766457098
Dev eval recall 0.6362179487145502
Dev eval accuracy 0.8077947705961442
Dev eval F1-score 0.5501154685301454

 dssm_fold2.h5 curr_fold: 2
Train on 161595 samples, validate on 23085 samples
Epoch 1/200
 - 38s - loss: 0.4781 - acc: 0.7996 - val_loss: 0.4321 - val_acc: 0.8224
Epoch 2/200
 - 36s - loss: 0.4228 - acc: 0.8249 - val_loss: 0.4142 - val_acc: 0.8271
Epoch 3/200
 - 36s - loss: 0.4028 - acc: 0.8303 - val_loss: 0.4103 - val_acc: 0.8292
Epoch 4/200
 - 36s - loss: 0.3865 - acc: 0.8355 - val_loss: 0.3935 - val_acc: 0.8320
Epoch 5/200
 - 36s - loss: 0.3728 - acc: 0.8403 - val_loss: 0.3982 - val_acc: 0.8300
Epoch 6/200
 - 36s - loss: 0.3594 - acc: 0.8464 - val_loss: 0.3919 - val_acc: 0.8317
Epoch 7/200
 - 36s - loss: 0.3447 - acc: 0.8521 - val_loss: 0.3966 - val_acc: 0.8316
Epoch 8/200
 - 36s - loss: 0.3299 - acc: 0.8586 - val_loss: 0.3935 - val_acc: 0.8324
Epoch 9/200
 - 36s - loss: 0.3126 - acc: 0.8659 - val_loss: 0.3968 - val_acc: 0.8331
Epoch 10/200
 - 36s - loss: 0.2952 - acc: 0.8737 - val_loss: 0.4133 - val_acc: 0.8330
Epoch 11/200
 - 36s - loss: 0.2773 - acc: 0.8819 - val_loss: 0.4162 - val_acc: 0.8307
Dev eval precision 0.4718761796886679
Dev eval recall 0.6677350427314758
Dev eval accuracy 0.8005920078926486
Dev eval F1-score 0.5529750006749913

 dssm_fold3.h5 curr_fold: 3
Train on 161595 samples, validate on 23085 samples
Epoch 1/200
 - 38s - loss: 0.4801 - acc: 0.8022 - val_loss: 0.4499 - val_acc: 0.8200
Epoch 2/200
 - 36s - loss: 0.4334 - acc: 0.8219 - val_loss: 0.4175 - val_acc: 0.8240
Epoch 3/200
 - 36s - loss: 0.4118 - acc: 0.8267 - val_loss: 0.4023 - val_acc: 0.8315
Epoch 4/200
 - 36s - loss: 0.3959 - acc: 0.8315 - val_loss: 0.3944 - val_acc: 0.8323
Epoch 5/200
 - 36s - loss: 0.3813 - acc: 0.8365 - val_loss: 0.3888 - val_acc: 0.8342
Epoch 6/200
 - 36s - loss: 0.3680 - acc: 0.8417 - val_loss: 0.3869 - val_acc: 0.8343
Epoch 7/200
 - 36s - loss: 0.3537 - acc: 0.8480 - val_loss: 0.3936 - val_acc: 0.8293
Epoch 8/200
 - 36s - loss: 0.3384 - acc: 0.8550 - val_loss: 0.3911 - val_acc: 0.8300
Epoch 9/200
 - 36s - loss: 0.3227 - acc: 0.8619 - val_loss: 0.3934 - val_acc: 0.8322
Epoch 10/200
 - 36s - loss: 0.3054 - acc: 0.8687 - val_loss: 0.4080 - val_acc: 0.8198
Epoch 11/200
 - 36s - loss: 0.2878 - acc: 0.8778 - val_loss: 0.4154 - val_acc: 0.8319
Dev eval precision 0.448177269476597
Dev eval recall 0.6698717948682166
Dev eval accuracy 0.7866798223968557
Dev eval F1-score 0.5370449630743743

 dssm_fold4.h5 curr_fold: 4
Train on 161595 samples, validate on 23085 samples
Epoch 1/200
 - 38s - loss: 0.4797 - acc: 0.8011 - val_loss: 0.4595 - val_acc: 0.8207
Epoch 2/200
 - 36s - loss: 0.4307 - acc: 0.8228 - val_loss: 0.4170 - val_acc: 0.8242
Epoch 3/200
 - 36s - loss: 0.4087 - acc: 0.8286 - val_loss: 0.4119 - val_acc: 0.8283
Epoch 4/200
 - 36s - loss: 0.3915 - acc: 0.8341 - val_loss: 0.3981 - val_acc: 0.8292
Epoch 5/200
 - 36s - loss: 0.3762 - acc: 0.8392 - val_loss: 0.3915 - val_acc: 0.8331
Epoch 6/200
 - 36s - loss: 0.3599 - acc: 0.8455 - val_loss: 0.3911 - val_acc: 0.8312
Epoch 7/200
 - 36s - loss: 0.3444 - acc: 0.8524 - val_loss: 0.3925 - val_acc: 0.8292
Epoch 8/200
 - 36s - loss: 0.3265 - acc: 0.8602 - val_loss: 0.3935 - val_acc: 0.8334
Epoch 9/200
 - 36s - loss: 0.3090 - acc: 0.8678 - val_loss: 0.4002 - val_acc: 0.8301
Epoch 10/200
 - 36s - loss: 0.2889 - acc: 0.8768 - val_loss: 0.4070 - val_acc: 0.8284
Epoch 11/200
 - 36s - loss: 0.2702 - acc: 0.8843 - val_loss: 0.4236 - val_acc: 0.8279
Dev eval precision 0.45235638114739474
Dev eval recall 0.7024572649535126
Dev eval accuracy 0.7879625061659714
Dev eval F1-score 0.5503243308672854

 dssm_fold5.h5 curr_fold: 5
Train on 161595 samples, validate on 23085 samples
Epoch 1/200
 - 39s - loss: 0.4791 - acc: 0.8011 - val_loss: 0.4319 - val_acc: 0.8210
Epoch 2/200
 - 36s - loss: 0.4268 - acc: 0.8240 - val_loss: 0.4116 - val_acc: 0.8283
Epoch 3/200
 - 36s - loss: 0.4062 - acc: 0.8284 - val_loss: 0.4082 - val_acc: 0.8284
Epoch 4/200
 - 36s - loss: 0.3910 - acc: 0.8329 - val_loss: 0.3972 - val_acc: 0.8346
Epoch 5/200
 - 36s - loss: 0.3787 - acc: 0.8379 - val_loss: 0.3920 - val_acc: 0.8345
Epoch 6/200
 - 36s - loss: 0.3662 - acc: 0.8426 - val_loss: 0.3902 - val_acc: 0.8332
Epoch 7/200
 - 36s - loss: 0.3520 - acc: 0.8482 - val_loss: 0.3931 - val_acc: 0.8330
Epoch 8/200
 - 36s - loss: 0.3382 - acc: 0.8537 - val_loss: 0.3927 - val_acc: 0.8306
Epoch 9/200
 - 36s - loss: 0.3231 - acc: 0.8608 - val_loss: 0.3984 - val_acc: 0.8336
Epoch 10/200
 - 36s - loss: 0.3074 - acc: 0.8678 - val_loss: 0.4041 - val_acc: 0.8345
Epoch 11/200
 - 36s - loss: 0.2910 - acc: 0.8761 - val_loss: 0.4242 - val_acc: 0.8107
Dev eval precision 0.45307557117591185
Dev eval recall 0.6885683760646979
Dev eval accuracy 0.788949185988368
Dev eval F1-score 0.5465338090751746

 dssm_fold6.h5 curr_fold: 6
Train on 161595 samples, validate on 23085 samples
Epoch 1/200
 - 39s - loss: 0.4777 - acc: 0.8000 - val_loss: 0.4304 - val_acc: 0.8258
Epoch 2/200
 - 37s - loss: 0.4208 - acc: 0.8243 - val_loss: 0.4099 - val_acc: 0.8289
Epoch 3/200
 - 36s - loss: 0.4013 - acc: 0.8302 - val_loss: 0.3981 - val_acc: 0.8324
Epoch 4/200
 - 37s - loss: 0.3872 - acc: 0.8348 - val_loss: 0.3939 - val_acc: 0.8338
Epoch 5/200
 - 37s - loss: 0.3743 - acc: 0.8393 - val_loss: 0.3902 - val_acc: 0.8358
Epoch 6/200
 - 37s - loss: 0.3625 - acc: 0.8443 - val_loss: 0.3884 - val_acc: 0.8372
Epoch 7/200
 - 36s - loss: 0.3481 - acc: 0.8508 - val_loss: 0.3908 - val_acc: 0.8381
Epoch 8/200
 - 37s - loss: 0.3345 - acc: 0.8570 - val_loss: 0.3906 - val_acc: 0.8358
Epoch 9/200
 - 37s - loss: 0.3185 - acc: 0.8630 - val_loss: 0.3986 - val_acc: 0.8351
Epoch 10/200
 - 37s - loss: 0.3027 - acc: 0.8704 - val_loss: 0.4084 - val_acc: 0.8291
Epoch 11/200
 - 37s - loss: 0.2858 - acc: 0.8781 - val_loss: 0.4074 - val_acc: 0.8361
Dev eval precision 0.4959796868366654
Dev eval recall 0.6260683760650317
Dev eval accuracy 0.8134188455838052
Dev eval F1-score 0.5534828758202032

 dssm_fold7.h5 curr_fold: 7
Train on 161595 samples, validate on 23085 samples
Epoch 1/200
 - 39s - loss: 0.4818 - acc: 0.7989 - val_loss: 0.4241 - val_acc: 0.8297
Epoch 2/200
 - 37s - loss: 0.4269 - acc: 0.8230 - val_loss: 0.4053 - val_acc: 0.8295
Epoch 3/200
 - 37s - loss: 0.4070 - acc: 0.8290 - val_loss: 0.3909 - val_acc: 0.8351
Epoch 4/200
 - 37s - loss: 0.3905 - acc: 0.8332 - val_loss: 0.3844 - val_acc: 0.8380
Epoch 5/200
 - 37s - loss: 0.3767 - acc: 0.8386 - val_loss: 0.3840 - val_acc: 0.8380
Epoch 6/200
 - 37s - loss: 0.3626 - acc: 0.8445 - val_loss: 0.3865 - val_acc: 0.8365
Epoch 7/200
 - 37s - loss: 0.3497 - acc: 0.8496 - val_loss: 0.3838 - val_acc: 0.8351
Epoch 8/200
 - 37s - loss: 0.3337 - acc: 0.8571 - val_loss: 0.3856 - val_acc: 0.8367
Epoch 9/200
 - 37s - loss: 0.3182 - acc: 0.8644 - val_loss: 0.3889 - val_acc: 0.8363
Epoch 10/200
 - 37s - loss: 0.3029 - acc: 0.8702 - val_loss: 0.3937 - val_acc: 0.8365
Epoch 11/200
 - 37s - loss: 0.2855 - acc: 0.8787 - val_loss: 0.4130 - val_acc: 0.8367
Epoch 12/200
 - 37s - loss: 0.2680 - acc: 0.8866 - val_loss: 0.4177 - val_acc: 0.8286
Dev eval precision 0.4469618949521217
Dev eval recall 0.6955128205091052
Dev eval accuracy 0.784805130734302
Dev eval F1-score 0.5442006221936238
final result and score...
Dev eval precision 0.48966553926911066
Dev eval recall 0.6960470085432904
Dev eval accuracy 0.8098667982231772
Dev eval F1-score 0.5748952080322429
